!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports["genies-typescript-compiler-plugin"]=t():e["genies-typescript-compiler-plugin"]=t()}(this,(()=>(()=>{"use strict";var e={26:(e,t,n)=>{const i=n(710),r=n(741),o=n(54),s=n(830),a=n(400),l=n(335),c=n(865),d=n(71);e.exports=e=>{let t,n;return{create:function(e){e.project.projectService.logger.info("I'm getting set up now! Check the log for this message."),t=new i.Project({compilerOptions:e.project.getCompilerOptions(),skipAddingFilesFromTsConfig:!0}),(0,d.setProjectRoot)(t.getFileSystem().getCurrentDirectory()),n=new l.GeniesLSPContext(t,e);const u=[new r.GeniesLifecycleEventsCompletions(n),new o.CSharpOperatorOverloadingSuppress(n),new s.GeniesLifecycleEventsDiagnostics(n),new a.GeniesScriptTypeDiagnostics(n),new c.GeniesSemanticDiagnostics(n)],p=Object.create(null);for(const t of Object.keys(e.languageService)){const n=e.languageService[t];p[t]=(...t)=>n.apply(e.languageService,t)}return u.forEach((e=>e.enhanceProxy(p))),p}}}},54:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CSharpOperatorOverloadingSuppress=void 0;const i=n(710),r=n(130);t.CSharpOperatorOverloadingSuppress=class{constructor(e){this.expressionValidity=[],this.context=e}get Logger(){return this.context.Logger}enhanceProxy(e){const t=e.getSemanticDiagnostics;e.getSemanticDiagnostics=e=>this.getSemanticDiagnostics(t,e)}getSemanticDiagnostics(e,t){const n=e(t),i=this.context.getSourceFile(t);if(!i)return n;this.collectExpressions(i);const r=n.filter((e=>{var t,n,i;const r=null!==(t=e.start)&&void 0!==t?t:0,o=(null!==(n=e.start)&&void 0!==n?n:0)+(null!==(i=e.length)&&void 0!==i?i:0);for(const e of this.expressionValidity)if(e.valid&&r>=e.start&&o<=e.end)return!1;return!0}));return this.expressionValidity=[],r}isCastable(e,t){return e.isAssignableTo(t)}collectExpressions(e){var t;const n=e.getDescendantsOfKind(i.SyntaxKind.BinaryExpression),o=e.getDescendantsOfKind(i.SyntaxKind.PrefixUnaryExpression),s=e.getDescendantsOfKind(i.SyntaxKind.PostfixUnaryExpression),a=e=>{const t=e.getStart(),n=e.getEnd(),i=(0,r.getOperatorNodeReturnType)(e,this.context),o=null!=i;this.context.Logger.info(`[FOUND TYPE] ${null==i?void 0:i.getText()} at Node ${e.getText()}`),this.expressionValidity.push({start:t,end:n,valid:o})};n.forEach(a),o.forEach(a),s.forEach(a);const l=n.filter((e=>e.getOperatorToken().getKind()===i.SyntaxKind.EqualsToken));for(const e of l){const t=e.getRight(),n=t.getStart(),i=t.getEnd();this.expressionValidity.some((e=>e.valid&&e.start<=n&&e.end>=i))&&this.expressionValidity.push({start:e.getStart(),end:e.getEnd(),valid:!0})}const c=e.getDescendantsOfKind(i.SyntaxKind.VariableDeclaration);for(const e of c){const t=e.getInitializer();if(!t)continue;const n=t.getStart(),i=t.getEnd();this.expressionValidity.some((e=>e.valid&&e.start<=n&&e.end>=i))&&this.expressionValidity.push({start:e.getStart(),end:e.getEnd(),valid:!0})}const d=e.getDescendantsOfKind(i.SyntaxKind.AsExpression);for(const e of d){const n=e.getExpression(),i=n.getStart(),o=n.getEnd();if(!this.expressionValidity.some((e=>e.valid&&e.start<=i&&e.end>=o)))continue;const s=null!==(t=(0,r.getOperatorNodeReturnType)(n,this.context))&&void 0!==t?t:this.context.TypeChecker.getTypeAtLocation(n),a=this.context.TypeChecker.getTypeAtLocation(e.getTypeNodeOrThrow());s.isAssignableTo(a)&&this.expressionValidity.push({start:e.getStart(),end:e.getEnd(),valid:!0})}}}},60:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ScriptableObjectAllowedMethods=t.unityLifecycleMethods=void 0,t.unityLifecycleMethods=[{name:"Awake",parameters:"",description:"Called when the script instance is being loaded.",imports:[]},{name:"Start",parameters:"",description:"Called before the first frame update.",imports:[]},{name:"OnEnable",parameters:"",description:"Called when the object becomes enabled and active.",imports:[]},{name:"OnDisable",parameters:"",description:"Called when the object becomes disabled.",imports:[]},{name:"OnDestroy",parameters:"",description:"Called when the MonoBehaviour will be destroyed.",imports:[]},{name:"Update",parameters:"",description:"Called once per frame.",imports:[]},{name:"FixedUpdate",parameters:"",description:"Called every fixed frame-rate frame.",imports:[]},{name:"LateUpdate",parameters:"",description:"Called once per frame after Update.",imports:[]},{name:"OnCollisionEnter",parameters:"collision: Collision",description:"Called when this collider/rigidbody has begun touching another rigidbody/collider.",imports:[{type:"Collision",module:"UnityEngine"}]},{name:"OnCollisionExit",parameters:"collision: Collision",description:"Called when this collider/rigidbody has stopped touching another rigidbody/collider.",imports:[{type:"Collision",module:"UnityEngine"}]},{name:"OnCollisionStay",parameters:"collision: Collision",description:"Called once per frame for every collider/rigidbody that is touching rigidbody/collider.",imports:[{type:"Collision",module:"UnityEngine"}]},{name:"OnCollisionEnter2D",parameters:"collision: Collision2D",description:"Called when this collider/rigidbody has begun touching another rigidbody/collider in 2D.",imports:[{type:"Collision2D",module:"UnityEngine"}]},{name:"OnCollisionExit2D",parameters:"collision: Collision2D",description:"Called when this collider/rigidbody has stopped touching another rigidbody/collider in 2D.",imports:[{type:"Collision2D",module:"UnityEngine"}]},{name:"OnCollisionStay2D",parameters:"collision: Collision2D",description:"Called once per frame for every collider/rigidbody that is touching rigidbody/collider in 2D.",imports:[{type:"Collision2D",module:"UnityEngine"}]},{name:"OnTriggerEnter",parameters:"other: Collider",description:"Called when the Collider other enters the trigger.",imports:[{type:"Collider",module:"UnityEngine"}]},{name:"OnTriggerExit",parameters:"other: Collider",description:"Called when the Collider other has stopped touching the trigger.",imports:[{type:"Collider",module:"UnityEngine"}]},{name:"OnTriggerStay",parameters:"other: Collider",description:"Called once per frame for every Collider other that is touching the trigger.",imports:[{type:"Collider",module:"UnityEngine"}]},{name:"OnTriggerEnter2D",parameters:"other: Collider2D",description:"Called when the Collider other enters the trigger in 2D.",imports:[{type:"Collider2D",module:"UnityEngine"}]},{name:"OnTriggerExit2D",parameters:"other: Collider2D",description:"Called when the Collider other has stopped touching the trigger in 2D.",imports:[{type:"Collider2D",module:"UnityEngine"}]},{name:"OnTriggerStay2D",parameters:"other: Collider2D",description:"Called once per frame for every Collider other that is touching the trigger in 2D.",imports:[{type:"Collider2D",module:"UnityEngine"}]},{name:"OnControllerColliderHit",parameters:"hit: ControllerColliderHit",description:"Called when the character controller hits a collider while performing a move.",imports:[{type:"ControllerColliderHit",module:"UnityEngine"}]},{name:"OnGUI",parameters:"",description:"Called for rendering and handling GUI events.",imports:[]},{name:"OnMouseDown",parameters:"",description:"Called when the user has pressed the mouse button while over the GUIElement or Collider.",imports:[]},{name:"OnMouseDrag",parameters:"",description:"Called when the user has clicked on a GUIElement or Collider and is still holding down the mouse.",imports:[]},{name:"OnMouseUp",parameters:"",description:"Called when the user has released the mouse button.",imports:[]},{name:"OnMouseEnter",parameters:"",description:"Called when the mouse enters the GUIElement or Collider.",imports:[]},{name:"OnMouseExit",parameters:"",description:"Called when the mouse is not any longer over the GUIElement or Collider.",imports:[]},{name:"OnMouseOver",parameters:"",description:"Called every frame while the mouse is over the GUIElement or Collider.",imports:[]},{name:"OnMouseUpAsButton",parameters:"",description:"Called when the user has pressed the mouse button while over the GUIElement or Collider and is still holding down the mouse.",imports:[]},{name:"OnApplicationFocus",parameters:"hasFocus: boolean",description:"Called when the application gains or loses focus.",imports:[]},{name:"OnApplicationPause",parameters:"pauseStatus: boolean",description:"Called when the application is paused or resumed.",imports:[]},{name:"OnApplicationQuit",parameters:"",description:"Called when the application is about to quit.",imports:[]},{name:"OnPreRender",parameters:"",description:"Called before a camera starts rendering the scene.",imports:[]},{name:"OnPostRender",parameters:"",description:"Called after a camera has finished rendering the scene.",imports:[]},{name:"OnRenderImage",parameters:"source: RenderTexture, destination: RenderTexture",description:"Called after all rendering is complete to render image.",imports:[{type:"RenderTexture",module:"UnityEngine"}]},{name:"OnRenderObject",parameters:"",description:"Called after camera has rendered the scene.",imports:[]},{name:"OnWillRenderObject",parameters:"",description:"Called once for each camera if the object is visible.",imports:[]},{name:"OnPreCull",parameters:"",description:"Called before the camera culls the scene.",imports:[]},{name:"OnAnimatorIK",parameters:"layerIndex: number",description:"Called right after the Animator has performed IK pass.",imports:[]},{name:"OnAnimatorMove",parameters:"",description:"Called right after the Animator updates.",imports:[]},{name:"OnDrawGizmos",parameters:"",description:"Called when the editor draws gizmos.",imports:[]},{name:"OnValidate",parameters:"",description:"Called when the script is loaded or a value is changed in the inspector.",imports:[]},{name:"OnExperiencePaused",parameters:"",description:"Called when the experience is paused.",imports:[]},{name:"OnExperienceResumed",parameters:"",description:"Called when the experience is resumed.",imports:[]},{name:"OnExperienceQuit",parameters:"",description:"Called when the experience is quit.",imports:[]}],t.ScriptableObjectAllowedMethods=["Awake","OnEnable","OnDisable","OnDestroy","OnValidate","OnApplicationFocus","OnApplicationPause","OnApplicationQuit","OnExperiencePaused","OnExperienceResumed","OnExperienceQuit"]},71:function(e,t,n){var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n);var r=Object.getOwnPropertyDescriptor(t,n);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,i,r)}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),r=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&i(t,e,n);return r(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.updateImportsToAliasPaths=t.convertToAliasPath=t.convertToGeniesAliasPath=t.isGeniesScriptType=t.getGeniesScriptTypeFromType=t.getIsUnityAPIDeclaration=t.isAssignmentToSymbol=t.cleanTypeText=t.getTypeByName=t.getIsUnityAPIType=t.getIsValidUnityGenericTypeArg=t.extractProperties=t.getFullTypeName=t.getTypeNameAndEnsureImported=t.ensureTypeImported=t.insertVariableStatements=t.sortImportsAndVars=t.isOrInheritsFromGameObjectOrComponent=t.isGeniesEventType=t.isSignalBusType=t.traversePrototypeChain=t.removeDecorators=t.extendsScriptableObject=t.extendsMonoBehaviour=t.setProjectRoot=t.GeniesScriptType=t.NumericalAliases=t.UiInterfaceToEnumMap=t.AllowedUiInterfaces=t.GeniesScriptUiEvents=t.componentMethods=t.SET_ITEM_NAME=t.GET_ITEM_NAME=t.TooltipDecorator=t.SpaceDecorator=t.HeaderDecorator=t.SerializeFieldDecorator=t.HideInInspectorDecorator=t.NonSerializedDecorator=t.ScriptableObjectTypeName=t.MonobehaviourTypeName=t.GeniesInstancePropName=t.GeniesDeclarationFileAnnotation=t.projectRoot=void 0;const s=n(710),a=o(n(928));var l;t.projectRoot="",t.GeniesDeclarationFileAnnotation="//@Genies-UnityApiInterface",t.GeniesInstancePropName="__geniesInstance__",t.MonobehaviourTypeName="MonoBehaviour",t.ScriptableObjectTypeName="ScriptableObject",t.NonSerializedDecorator="NonSerialized",t.HideInInspectorDecorator="HideInInspector",t.SerializeFieldDecorator="SerializeField",t.HeaderDecorator="Header",t.SpaceDecorator="Space",t.TooltipDecorator="Tooltip",t.GET_ITEM_NAME="get_Item",t.SET_ITEM_NAME="set_Item",t.componentMethods=new Set(["GetComponent","TryGetComponent","GetComponentInChildren","GetComponentsInChildren","GetComponentInParent","GetComponentsInParent","GetComponents","AddComponent"]),function(e){e[e.None=0]="None",e[e.PointerClick=1]="PointerClick",e[e.PointerDown=2]="PointerDown",e[e.PointerEnter=4]="PointerEnter",e[e.PointerExit=8]="PointerExit",e[e.PointerUp=16]="PointerUp",e[e.BeginDrag=32]="BeginDrag",e[e.Deselect=64]="Deselect",e[e.Drag=128]="Drag",e[e.Drop=256]="Drop",e[e.EndDrag=512]="EndDrag",e[e.InitializePotentialDrag=1024]="InitializePotentialDrag",e[e.Scroll=2048]="Scroll",e[e.Select=4096]="Select",e[e.Submit=8192]="Submit",e[e.UpdateSelected=16384]="UpdateSelected",e[e.Move=32768]="Move",e[e.Cancel=65536]="Cancel"}(l||(t.GeniesScriptUiEvents=l={})),t.AllowedUiInterfaces=new Set(["UnityEngine.EventSystems.IPointerClickHandler","UnityEngine.EventSystems.IPointerDownHandler","UnityEngine.EventSystems.IPointerEnterHandler","UnityEngine.EventSystems.IPointerExitHandler","UnityEngine.EventSystems.IPointerUpHandler","UnityEngine.EventSystems.IBeginDragHandler","UnityEngine.EventSystems.IDeselectHandler","UnityEngine.EventSystems.IDragHandler","UnityEngine.EventSystems.IDropHandler","UnityEngine.EventSystems.IEndDragHandler","UnityEngine.EventSystems.IInitializePotentialDragHandler","UnityEngine.EventSystems.IScrollHandler","UnityEngine.EventSystems.ISelectHandler","UnityEngine.EventSystems.ISubmitHandler","UnityEngine.EventSystems.IUpdateSelectedHandler","UnityEngine.EventSystems.IMoveHandler","UnityEngine.EventSystems.ICancelHandler"]),t.UiInterfaceToEnumMap=new Map([["UnityEngine.EventSystems.IPointerClickHandler",l.PointerClick],["UnityEngine.EventSystems.IPointerDownHandler",l.PointerDown],["UnityEngine.EventSystems.IPointerEnterHandler",l.PointerEnter],["UnityEngine.EventSystems.IPointerExitHandler",l.PointerExit],["UnityEngine.EventSystems.IPointerUpHandler",l.PointerUp],["UnityEngine.EventSystems.IBeginDragHandler",l.BeginDrag],["UnityEngine.EventSystems.IDeselectHandler",l.Deselect],["UnityEngine.EventSystems.IDragHandler",l.Drag],["UnityEngine.EventSystems.IDropHandler",l.Drop],["UnityEngine.EventSystems.IEndDragHandler",l.EndDrag],["UnityEngine.EventSystems.IInitializePotentialDragHandler",l.InitializePotentialDrag],["UnityEngine.EventSystems.IScrollHandler",l.Scroll],["UnityEngine.EventSystems.ISelectHandler",l.Select],["UnityEngine.EventSystems.ISubmitHandler",l.Submit],["UnityEngine.EventSystems.IUpdateSelectedHandler",l.UpdateSelected],["UnityEngine.EventSystems.IMoveHandler",l.Move],["UnityEngine.EventSystems.ICancelHandler",l.Cancel]]);const c=new Map([["float","Single"],["int","Int32"],["double","Double"],["long","Int64"],["bool","Boolean"],["string","String"],["number","Double"],["short","Int16"],["ushort","UInt16"],["byte","Byte"],["sbyte","SByte"],["uint","UInt32"],["char","Char"]]),d=new Map([["float","System.Single"],["int","System.Int32"],["double","System.Double"],["long","System.Int64"],["bool","System.Boolean"],["string","System.String"],["number","System.Double"],["short","System.Int16"],["ushort","System.UInt16"],["byte","System.Byte"],["sbyte","System.SByte"],["uint","System.UInt32"],["char","System.Char"]]);var u;function p(e){let t=e.getBaseClass();for(;t;){if("MonoBehaviour"===t.getName())return!0;t=t.getBaseClass()}return!1}function g(e){let t=e.getBaseClass();for(;t;){if("ScriptableObject"===t.getName())return!0;t=t.getBaseClass()}return!1}function m(e,t,n){var i;const r=function(e,t){const n=[],i=e.getSymbol();if(!i)return n;const r=i.getDeclarations();if(!r)return n;for(const e of r)if(s.Node.isClassDeclaration(e)){const i=e.getHeritageClauses();for(const e of i){const i=e.getTypeNodes();for(const e of i){const i=t.typeChecker.getTypeAtLocation(e);i&&n.push(i)}}}return n}(e,n);for(const e of r){const r=null===(i=e.getSymbol())||void 0===i?void 0:i.getName();if(r&&t.includes(r))return!0;if(m(e,t,n))return!0}return!1}function y(e,n=!0,i=!0){let r="";const o=e.getAliasSymbol();if(r=o?o.getName():e.getText(),d.has(r))return d.get(r);const l=e.getSymbol();if(!l)return r;if(b(e))r=l.getFullyQualifiedName().replace(/['"]/g,"");else{const e=l.getDeclarations();let n=!1;if(e.forEach((e=>{(s.Node.isInterfaceDeclaration(e)||s.Node.isClassDeclaration(e))&&(n=e.isExported())})),!n&&e.length>0){const n=e[0].getSourceFile().getFilePath(),i=N(t.projectRoot,n),o=a.parse(i),s=a.join(o.dir,o.name);r=`${s}.${l.getFullyQualifiedName().replace(/['"]/g,"")}`}else r=l.getFullyQualifiedName().replace(/['"]/g,"");const i=a.parse(r);if(""!==i.dir||""!==i.root){let e=I(r);null!=e&&(r=e)}}const c=/\$\d+$/;if(n&&c.test(r)&&(r=r.replace(c,""),i)){const t=e.getTypeArguments();t.length>0&&(r+="<",t.forEach(((e,n)=>{let i=y(e);r+=i,n<t.length-1&&(r+=", ")})),r+=">")}return r}function h(e,n="",i=new Map){const r=[];return e.getProperties().forEach((e=>{const o=e.getScope(),a=P(e);if(e.isStatic()||e.isReadonly())return;if("private"===o&&!a.some((e=>e.Type===t.SerializeFieldDecorator)))return;if("public"===o&&a.some((e=>e.Type===t.NonSerializedDecorator)))return;const l=T(e.getType(),i),c=l.isArray(),d=E(l,i),u=y(d),p=e.getName();let g=n?`${n}.${p}`:p;function m(e){if(e.getKind()===s.SyntaxKind.NewExpression){const t=e;return`new ${y(t.getType())}(${t.getArguments().map((e=>e.getText())).join(", ")});`}if(e.getKind()===s.SyntaxKind.PropertyAccessExpression){const t=e;return`${y(t.getExpression().getType())}.${t.getName()}`}return e.getText()}const h=[];if(e.hasInitializer()){const t=e.getInitializer();if(t)if(t.getKind()===s.SyntaxKind.ArrayLiteralExpression){const e=t;for(let t=0;t<e.getElements().length;t++){const n=e.getElements()[t];h.push(m(n))}}else h.push(m(t))}const x={Path:g,Name:p,TypeName:u,ChildProperties:[],IsArray:c,IsEnum:!1,EnumKeys:[],EnumValues:[],Decorators:P(e),IsGeniesBehaviourRef:!1,IsGeniesScriptableObjectRef:!1,Initializers:h,ArrayElementInitializer:void 0,ArrayDimension:-1};if(c){let e=1;return x.ArrayElementInitializer=S(l,u,p,g,e,i),x.ArrayDimension=e,void r.push(x)}f(d,x,i),r.push(x)})),r}function f(e,t,n){const i=e.isEnum(),r=e.getSymbol()||e.getAliasSymbol();if(!r)return;const o=r.getDeclarations()[0],a=v(o),l=C(o,a);if(t.IsGeniesBehaviourRef=l==u.Monobehaviour,t.IsGeniesScriptableObjectRef=l==u.ScriptableObject,!a&&l===u.None&&(i&&function(e,t){const{keys:n,values:i}=function(e){const t=e.getSymbol(),n=null==t?void 0:t.getDeclarations().find((e=>e.getKind()===s.SyntaxKind.EnumDeclaration));return n?{keys:n.getMembers().map((e=>e.getName())),values:n.getMembers().map((e=>e.getValue()))}:{keys:[],values:[]}}(t);e.EnumKeys=n,e.EnumValues=i.map((e=>void 0===e?"":e.toString())),e.IsEnum=!0}(t,e),r.getDeclarations().some((e=>s.Node.isClassDeclaration(e))))){const i=r.getDeclarations().find(s.Node.isClassDeclaration),o=i.getTypeParameters(),a=e.getTypeArguments(),l=new Map(n);o.forEach(((e,t)=>{const n=`${e.getName()}_${i.getName()}`;l.set(n,a[t])}));const c=[];let d=i;for(;d;){d.getName(),c.unshift(...h(d,t.Path,l));let e=d.getBaseClass();if(void 0===e)break;d=e}t.ChildProperties=c}}function S(e,t,n,i,r,o){let s=e.isArray()?e.getArrayElementType():e;s.isArray()||(s=E(s,o));let a=r;const l={Path:i+"_D"+r,Name:n,TypeName:t,ArrayDimension:r,ChildProperties:[],IsArray:s.isArray(),IsEnum:s.isEnum(),EnumKeys:[],EnumValues:[],Decorators:[],IsGeniesBehaviourRef:!1,IsGeniesScriptableObjectRef:!1,Initializers:[],ArrayElementInitializer:void 0};return s.isArray()?l.ArrayElementInitializer=S(s,t,n,i,++a,o):f(s,l,o),l}function T(e,t){var n,i;let r=e;if(r.isTypeParameter()){const e=null===(n=r.getSymbol())||void 0===n?void 0:n.getName(),o=null===(i=r.getSymbol())||void 0===i?void 0:i.getDeclarations()[0].getParent(),a=`${e}_${o&&s.Node.isClassDeclaration(o)?o.getName():""}`;a&&t.has(a)&&(r=t.get(a))}return r}function E(e,t){let n=e;for(;null==n?void 0:n.isArray();)n=n.getArrayElementType();return n=T(n,t),n}function x(e){if(!e)return!1;const n=e.getFirstChild();if(!n)return console.log("No nodes found in the file."),!1;const i=n.getLeadingCommentRanges();return i.length>0&&i[0].getText()===t.GeniesDeclarationFileAnnotation}function b(e){let t=e.getSymbol();if(!t){let t=e.getApparentType().getSymbol();return void(t&&console.log(t.getName()))}const n=t.getDeclarations();if(n&&0!==n.length)return x(n[0].getSourceFile())}function v(e){return x(e.getSourceFile())}function C(e,t){if(e.getKind()!==s.SyntaxKind.ClassDeclaration||t)return u.None;const n=e,i=p(n),r=g(n);return i?u.Monobehaviour:r?u.ScriptableObject:u.None}function D(e){const t=e.getSymbol();if(!t)return u.None;const n=t.getDeclarations();if(0===n.length)return u.None;const i=n[0];return C(i,v(i))}function I(e){const t=e.split(a.sep).join("/"),n=t.indexOf("/Assets/");if(-1!==n)return`@assets/${t.substring(n+8)}`;const i=t.match(/\/(com\.genies\.[^\/]+)\//);return i?`@${i[1]}/${t.substring(i.index+i[0].length)}`:null}function N(e,t){return I(a.resolve(e,t))||t}function P(e){return e.getDecorators().map((e=>({Type:e.getName(),Args:e.getArguments().map((e=>e.getText()))})))}t.NumericalAliases=new Set(["byte","sbyte","short","ushort","int","uint","float","double","number"]),function(e){e[e.None=0]="None",e[e.Monobehaviour=1]="Monobehaviour",e[e.ScriptableObject=2]="ScriptableObject"}(u||(t.GeniesScriptType=u={})),t.setProjectRoot=function(e){t.projectRoot=e},t.extendsMonoBehaviour=p,t.extendsScriptableObject=g,t.removeDecorators=function(e,t){e.forEach((e=>{try{t(e)&&e.remove()}catch(e){}}))},t.traversePrototypeChain=function(e){const t=new Set;let n=e;for(;n;){const e=y(n.getType());e&&t.add(e),n.getImplements().forEach((e=>{const n=[e.getType()];for(;n.length>0;){const e=n.shift();if(!e)continue;const i=y(e);i&&!t.has(i)&&(t.add(i),e.getBaseTypes().forEach((e=>{n.push(e)})))}})),n=n.getBaseClass()}return Array.from(t)},t.isSignalBusType=function(e){const t=e.getSymbol();return!!t&&"SignalBus"===t.getName()},t.isGeniesEventType=function(e){const t=e.getSymbol();return!!t&&"GeniesEvent"===t.getName()},t.isOrInheritsFromGameObjectOrComponent=function(e,t){if(!e)return!1;const n=e.getSymbol();return!!n&&(!!["GameObject","Component","MonoBehaviour"].includes(n.getName())||m(e,["GameObject","Component","MonoBehaviour"],t))},t.sortImportsAndVars=function(e){const t=e.getStatements(),n=t.filter((e=>e.getKind()===s.SyntaxKind.ImportDeclaration)),i=t.filter((e=>e.getKind()===s.SyntaxKind.VariableStatement)),r=t.filter((e=>e.getKind()!==s.SyntaxKind.ImportDeclaration&&e.getKind()!==s.SyntaxKind.VariableStatement)),o=[...n.map((e=>e.getText())),"",...i.map((e=>e.getText())),"",...r.map((e=>e.getText()))].join("\n\n");e.replaceWithText(o)},t.insertVariableStatements=function(e,t,n){if(0===t.length)return;let i;i=n.lastGenericTypeVarIndex.has(e)?n.lastGenericTypeVarIndex.get(e):function(e){const t=e.getStatements();let n=-1;return t.forEach(((e,t)=>{e.getKind()===s.SyntaxKind.ImportDeclaration&&(n=t)})),n}(e)+1;const r=e.getStatements().length;i=Math.min(i,r),e.insertVariableStatements(i,t),n.lastGenericTypeVarIndex.set(e,i+t.length)},t.ensureTypeImported=function(e,t){var n,i;let r=null!==(i=null===(n=e.getSymbol())||void 0===n?void 0:n.getName())&&void 0!==i?i:e.getText(),o="";if(c.has(r))r=c.get(r),o="System";else{const t=D(e);if(t!==u.None)switch(t){case u.Monobehaviour:r="MonoBehaviour",o="UnityEngine";break;case u.ScriptableObject:r="ScriptableObject",o="UnityEngine"}else{if(!b(e))throw new Error("Can't use non CSharp types");{const t=y(e,!0,!1),n=t.lastIndexOf(".");o=t.substring(0,n)}}}const a=t.getImportDeclarations().find((e=>e.getModuleSpecifierValue()===o));if(a)a.getNamedImports().some((e=>e.getName()===r))||a.addNamedImport(r);else{const e={kind:s.StructureKind.ImportDeclaration,moduleSpecifier:o,namedImports:[{name:r}]};t.addImportDeclaration(e)}},t.getTypeNameAndEnsureImported=function(e,t){var n,i;let r=null!==(i=null===(n=e.getSymbol())||void 0===n?void 0:n.getName())&&void 0!==i?i:e.getText(),o="",a="";if(c.has(r))o=r=c.get(r),a="System";else{const t=D(e);if(t!==u.None)switch(t){case u.Monobehaviour:r="MonoBehaviour",a="UnityEngine";break;case u.ScriptableObject:r="ScriptableObject",a="UnityEngine"}else{if(!b(e))throw new Error("Can't use non CSharp types");{o=y(e,!0,!1);const t=o.lastIndexOf(".");a=o.substring(0,t)}}}const l=t.getImportDeclarations().find((e=>e.getModuleSpecifierValue()===a));if(l)l.getNamedImports().some((e=>e.getName()===r))||l.addNamedImport(r);else{const e={kind:s.StructureKind.ImportDeclaration,moduleSpecifier:a,namedImports:[{name:r}]};t.addImportDeclaration(e)}return`$typeof("${o}")`},t.getFullTypeName=y,t.extractProperties=h,t.getIsValidUnityGenericTypeArg=function(e){let t="";const n=e.getAliasSymbol();return t=n?n.getName():e.getText(),!!["float","int","double","long","bool","string","number"].includes(t)||D(e)!==u.None||b(e)},t.getIsUnityAPIType=b,t.getTypeByName=function(e,t){const n=t.resolveName(e,void 0,s.SymbolFlags.All,!1);return n?t.getDeclaredTypeOfSymbol(n):void console.log(`Global type '${e}' not found.`)},t.cleanTypeText=function(e){return e.replace(/&\s*\{[^}]*\}/,"").trim()},t.isAssignmentToSymbol=function(e,t){if(s.Node.isPropertyAccessExpression(e)){const n=e.getExpression();if(s.Node.isThisExpression(n))return e.getNameNode().getSymbol()===t}else if(s.Node.isIdentifier(e))return e.getSymbol()===t;return!1},t.getIsUnityAPIDeclaration=v,t.getGeniesScriptTypeFromType=D,t.isGeniesScriptType=function(e){let t=D(e);return t===u.Monobehaviour||t===u.ScriptableObject},t.convertToGeniesAliasPath=I,t.convertToAliasPath=N,t.updateImportsToAliasPaths=function(e){const t=e.getDirectoryPath();e.getImportDeclarations().forEach((e=>{const n=e.getModuleSpecifierValue();if(n.startsWith("./")||n.startsWith("../")){const i=N(t,n);(i.startsWith("@assets/")||i.startsWith("@com.genies"))&&e.setModuleSpecifier(i)}}))}},101:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getNumericValue=t.typesAreEqual=t.isNumericCastable=t.selectBestOverload=t.inferPossibleTypes=void 0;const i=n(710),r=n(71);function o(e,t){const n=[],i=t.getTypeAtLocation(e);let o=[];const s=function(e,t){const n=e.getText();if(r.NumericalAliases.has(n)){const e=(0,r.getTypeByName)(n,t);if(e)return e}const i=n.match(/number\s*&\s*\{\s*__([a-zA-Z]+)Brand\?:\s*undefined\s*\}/);if(i){const e=i[1],n=(0,r.getTypeByName)(e,t);if(n)return n}return null}(i,t);if(null!=s)n.push(s);else{const t=d(e);if(void 0!==t)o=function(e){const{value:t,hasDecimal:n}=e,i=new Set;return n?(i.add("float"),i.add("double")):(t>=-2147483648&&t<=2147483647&&i.add("int"),t>=-32768&&t<=32767&&i.add("short"),t>=-128&&t<=127&&i.add("sbyte"),t>=0&&t<=255&&i.add("byte"),t>=0&&t<=65535&&i.add("ushort"),t>=0&&t<=4294967295&&i.add("uint")),Array.from(i)}(t);else{if(a=i,"number"!==(0,r.cleanTypeText)(a.getText()))return n.push(i),n;o=["byte","sbyte","short","ushort","int","uint","float","double"]}}var a;for(const e of o){const i=(0,r.getTypeByName)(e,t);i&&n.push(i)}return n}function s(e,t,n){const i=e.getParameters();if(i.length<t.length)return-1;let r=i.length==t.length?1:0;for(let e=0;e<i.length;e++){const o=n.getTypeAtLocation(i[e]),s=t[e];if(!s||s.length<=0)return-1;const l=a(o,s,n);if(l<0)return-1;r+=l}return r}function a(e,t,n){let i=-1;if(e.isTypeParameter()){const r=e.getConstraint();if(!r)return t.length>0?1:-1;for(const e of t)c(e,r)?i=Math.max(i,2):n.isTypeAssignableTo(e,r)&&(i=Math.max(i,1));return i}if(function(e){const t=(0,r.cleanTypeText)(e.getText());return r.NumericalAliases.has(t)}(e)){for(const n of t)c(n,e)?i=Math.max(i,2):l(n,e)&&(i=Math.max(i,1));return i}for(const r of t)c(r,e)?i=Math.max(i,2):n.isTypeAssignableTo(r,e)&&(i=Math.max(i,1));return i}function l(e,t){var n,i;const o=(0,r.cleanTypeText)(e.getText()),s=(0,r.cleanTypeText)(t.getText());return null!==(i=null===(n={byte:["short","ushort","int","uint","float","double","number"],sbyte:["short","int","float","double","number"],short:["int","float","double","number"],ushort:["int","uint","float","double","number"],int:["float","double","number"],uint:["float","double","number"],float:["double","number"],double:["number"],number:["byte","sbyte","short","ushort","int","uint","float","double"]}[o])||void 0===n?void 0:n.includes(s))&&void 0!==i&&i}function c(e,t){return(0,r.cleanTypeText)(e.getText())===(0,r.cleanTypeText)(t.getText())}function d(e){const t=u(e);if(void 0!==t)return t;if(i.Node.isIdentifier(e)||i.Node.isPropertyAccessExpression(e)){const t=e.getSymbol();if(t){const n=t.getDeclarations();if(n&&n.length>0){const r=n[0];if(i.Node.isVariableDeclaration(r)||i.Node.isPropertyDeclaration(r)){const n=p(t,r,e);if(n)return n}}}}}function u(e){if(i.Node.isNumericLiteral(e)){const t=e.getText();return{value:Number(t),hasDecimal:t.includes(".")}}if(i.Node.isPrefixUnaryExpression(e)&&e.getOperatorToken()===i.SyntaxKind.MinusToken){const t=e.getOperand();if(i.Node.isNumericLiteral(t)){const e=t.getText();return{value:-Number(e),hasDecimal:e.includes(".")}}}}function p(e,t,n){let o;const s=t.getInitializer();if(s){const i=g(s,e,t,n);i&&(o=i)}const a=n.getFirstAncestorByKind(i.SyntaxKind.MethodDeclaration);if(!a)return o;const l=a.getStatements()||[],c=n.getStart();for(const s of l){if(s.getStart()>c)break;{const a=s.getDescendants().filter((e=>i.Node.isBinaryExpression(e)||i.Node.isPrefixUnaryExpression(e)||i.Node.isPostfixUnaryExpression(e)));for(const s of a)if(i.Node.isBinaryExpression(s)){const a=s.getOperatorToken().getKind(),l=s.getLeft(),c=s.getRight();if((0,r.isAssignmentToSymbol)(l,e))if(a===i.SyntaxKind.EqualsToken){o=g(c,e,t,n,o)||void 0}else if([i.SyntaxKind.PlusEqualsToken,i.SyntaxKind.MinusEqualsToken,i.SyntaxKind.AsteriskEqualsToken,i.SyntaxKind.SlashEqualsToken,i.SyntaxKind.PercentEqualsToken].includes(a)){const i=g(c,e,t,n,o);if(i&&o){o=m(a,o,i)||void 0}else o=void 0}}else if(i.Node.isPrefixUnaryExpression(s)||i.Node.isPostfixUnaryExpression(s)){const t=s.getOperatorToken(),n=s.getOperand();if((0,r.isAssignmentToSymbol)(n,e))if(o){let e=t===i.SyntaxKind.PlusPlusToken?1:-1;o={value:o.value+e,hasDecimal:o.hasDecimal}}else o=void 0}}}return o}function g(e,t,n,o,s){if(i.Node.isNumericLiteral(e))return u(e);if(i.Node.isIdentifier(e)||i.Node.isPropertyAccessExpression(e)){if((0,r.isAssignmentToSymbol)(e,t))return s;{const t=e.getSymbol();if(t){const n=t.getDeclarations();if(n&&n.length>0){const r=n[0];if(i.Node.isVariableDeclaration(r)||i.Node.isPropertyDeclaration(r))return p(t,r,e)}}}}else if(i.Node.isBinaryExpression(e)){const i=g(e.getLeft(),t,n,o,s),r=g(e.getRight(),t,n,o,s);if(i&&r)return y(e.getOperatorToken().getKind(),i,r)}}function m(e,t,n){const r={[i.SyntaxKind.PlusEqualsToken]:i.SyntaxKind.PlusToken,[i.SyntaxKind.MinusEqualsToken]:i.SyntaxKind.MinusToken,[i.SyntaxKind.AsteriskEqualsToken]:i.SyntaxKind.AsteriskToken,[i.SyntaxKind.SlashEqualsToken]:i.SyntaxKind.SlashToken,[i.SyntaxKind.PercentEqualsToken]:i.SyntaxKind.PercentToken}[e];if(void 0!==r)return y(r,t,n)}function y(e,t,n){let r,o=t.hasDecimal||n.hasDecimal;switch(e){case i.SyntaxKind.PlusToken:r=t.value+n.value;break;case i.SyntaxKind.MinusToken:r=t.value-n.value;break;case i.SyntaxKind.AsteriskToken:r=t.value*n.value;break;case i.SyntaxKind.SlashToken:r=t.value/n.value,o=!0;break;case i.SyntaxKind.PercentToken:r=t.value%n.value;break;default:return}if(void 0!==r)return{value:r,hasDecimal:o}}t.inferPossibleTypes=o,t.selectBestOverload=function(e,t,n){if(!e||e.length<=0)return;if(1==e.length)return e[0];const i=t.getArguments();if(!i||i.length<=0){return e.find((e=>0===e.getParameters().length))||void 0}const r=t.getArguments().map((e=>o(e,n)));let a,l=-1;for(const t of e){const e=s(t,r,n);e>l&&(l=e,a=t)}return a},t.isNumericCastable=l,t.typesAreEqual=c,t.getNumericValue=d},105:function(e,t,n){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.getGeniesSemanticDiagnostics=void 0;const r=n(710),o=i(n(985)),s=n(71),a=10006,l=new Set(["MonoBehaviour","ScriptableObject"]),c=new Set(["GetComponent","TryGetComponent","GetComponentInChildren","GetComponentsInChildren","GetComponentInParent","GetComponentsInParent","GetComponents","AddComponent"]);function d(e,t,n,i){const r=t.getStart(),s=t.getWidth(),a={file:t.getSourceFile().compilerNode,start:r,length:s,messageText:n,category:o.default.DiagnosticCategory.Error,code:i,source:"Genies"};e.push(a)}t.getGeniesSemanticDiagnostics=function(e,t){if(!e)return[];const n=[];return function(e,t){e.getClasses().forEach((n=>{var i;const r=n.getBaseClass(),a=n.getImplements(),c=null==r?void 0:r.getName();if(r&&(0,s.getIsUnityAPIType)(r.getType())&&c&&!l.has(c)){const s=r.getStart(),a=null===(i=r.getName())||void 0===i?void 0:i.length,l=`Class '${n.getName()}' inherits from a Unity type '${r.getName()}' that is not 'MonoBehaviour' or 'ScriptableObject'.`,c={file:e.compilerNode,start:s,length:a,messageText:l,category:o.default.DiagnosticCategory.Error,code:10001,source:"Genies"};t.push(c)}a.forEach((i=>{if((0,s.getIsUnityAPIType)(i.getType())){const r=(0,s.getFullTypeName)(i.getType());if(s.AllowedUiInterfaces.has(r))return;const a=i.getStart(),l=i.getWidth(),c=`Class '${n.getName()}' implements a forbidden Unity interface '${i.getText()}'.`,d={file:e.compilerNode,start:a,length:l,messageText:c,category:o.default.DiagnosticCategory.Error,code:10002,source:"Genies"};t.push(d)}}))}))}(e,n),function(e,t){e.getDescendantsOfKind(r.SyntaxKind.CallExpression).forEach((e=>{!function(e,t){const n=e.getExpression();let i=[];if(r.Node.isPropertyAccessExpression(n)||r.Node.isIdentifier(n)){const e=n.getSymbol();e&&(i=e.getDeclarations().filter((e=>r.Node.isMethodDeclaration(e))))}if(0===i.length)return;if(!(i.filter((e=>e.getTypeParameters().length>0)).length>0))return;if(i=i.filter((e=>(0,s.getIsUnityAPIDeclaration)(e))),0===i.length)return;const o=function(e){return r.Node.isPropertyAccessExpression(e)?e.getName():r.Node.isIdentifier(e)?e.getText():""}(n);if(function(e,t){const n=t.getArguments().map((e=>e.getType())),i=t.getProject().getTypeChecker();return e.some((e=>{if(e.getTypeParameters().length>0)return!1;const t=e.getParameters();if(t.length!==n.length)return!1;for(let e=0;e<t.length;e++){const r=t[e].getType(),o=n[e];if(!i.isTypeAssignableTo(o,r))return!1}return!0}))}(i,e))return;const l=e.getTypeArguments();if(0===l.length)return void d(t,e,`Generic method '${o}' must be called with type arguments.`,10003);let u=i.map((e=>e.getTypeParameters().length));u.includes(l.length)||d(t,e,`Generic method '${o}' was provided the wrong number of arguments. Valid args counts: '${u.join(", ")}'`,a),c.has(o)?l.forEach((e=>{(function(e){const t=e.getType();if((0,s.getIsUnityAPIType)(t))return!0;if((0,s.getGeniesScriptTypeFromType)(t)===s.GeniesScriptType.Monobehaviour)return!0;const n=t.getSymbol();if(n){const e=n.getDeclarations();if(e&&e.length>0&&r.Node.isInterfaceDeclaration(e[0]))return!0}return!1})(e)||d(t,e,`Type arguments for method '${o}' must be a Unity API type, an interface, or a type that extends MonoBehaviour.`,10004)})):l.forEach((e=>{const n=e.getType();(0,s.getIsValidUnityGenericTypeArg)(n)||d(t,e,`Type arguments for method '${o}' must be Unity API types.`,10004)}))}(e,t)}))}(e,n),function(e,t){e.getDescendantsOfKind(r.SyntaxKind.NewExpression).forEach((e=>{const n=e.getType().getSymbol();if(!n)return;const i=n.getDeclarations();if(!i||0===i.length)return;const o=i.filter((e=>r.Node.isClassDeclaration(e)&&(0,s.getIsUnityAPIDeclaration)(e)&&e.getTypeParameters().length>0));if(0===o.length)return;const l=o[0].getTypeParameters().length,c=e.getTypeArguments(),u=c.length;0===u?d(t,e,`Generic class '${(0,s.getFullTypeName)(e.getType())}' must be instantiated with ${l} type argument(s).`,10005):(u!==l&&d(t,e,`Generic class '${(0,s.getFullTypeName)(e.getType())}' expects ${l} type argument(s), but got ${u}.`,a),c.forEach((n=>{const i=n.getType();(0,s.getIsValidUnityGenericTypeArg)(i)||d(t,n,`Type arguments for type '${(0,s.getFullTypeName)(e.getType())}' must be Unity API types.`,a)})))}))}(e,n),n}},130:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getOperatorNodeReturnType=t.getUnaryOperatorMethodReturnType=t.getEquivalentOperatorForCompound=t.isCompoundAssignment=t.unwrapParenthesizedExpression=t.getOperatorMethodName=t.getOperatorMethodReturnType=void 0;const i=n(710),r=n(71),o=n(101);function s(e,t,n,r){const s=t.getSymbol();if(!s)return null;const a=s.getDeclarations();for(const s of a)if(i.Node.isClassDeclaration(s)){const i=s.getMethods().filter((e=>e.getName()===n&&0===e.getTypeParameters().length));for(const n of i){const i=n.getParameters();if(2===i.length){const s=i[0].getType(),a=i[1].getType(),l=(0,o.typesAreEqual)(a,r)||e.isTypeAssignableTo(r,a);if(((0,o.typesAreEqual)(s,t)||e.isTypeAssignableTo(t,s))&&l)return n.getReturnType()}}}return null}function a(e,t=!1){if(t)switch(e){case i.SyntaxKind.MinusToken:return"op_UnaryNegation";case i.SyntaxKind.PlusToken:return"op_UnaryPlus";case i.SyntaxKind.ExclamationToken:return"op_LogicalNot";case i.SyntaxKind.TildeToken:return"op_OnesComplement";case i.SyntaxKind.PlusPlusToken:return"op_Increment";case i.SyntaxKind.MinusMinusToken:return"op_Decrement";default:return}else switch(e){case i.SyntaxKind.PlusToken:return"op_Addition";case i.SyntaxKind.MinusToken:return"op_Subtraction";case i.SyntaxKind.AsteriskToken:return"op_Multiply";case i.SyntaxKind.SlashToken:return"op_Division";case i.SyntaxKind.PercentToken:return"op_Modulus";case i.SyntaxKind.EqualsEqualsToken:case i.SyntaxKind.EqualsEqualsEqualsToken:return"op_Equality";case i.SyntaxKind.ExclamationEqualsToken:case i.SyntaxKind.ExclamationEqualsEqualsToken:return"op_Inequality";case i.SyntaxKind.GreaterThanToken:return"op_GreaterThan";case i.SyntaxKind.LessThanToken:return"op_LessThan";case i.SyntaxKind.GreaterThanEqualsToken:return"op_GreaterThanOrEqual";case i.SyntaxKind.LessThanEqualsToken:return"op_LessThanOrEqual";case i.SyntaxKind.BarToken:return"op_BitwiseOr";case i.SyntaxKind.AmpersandToken:return"op_BitwiseAnd";case i.SyntaxKind.CaretToken:return"op_ExclusiveOr";case i.SyntaxKind.LessThanLessThanToken:return"op_LeftShift";case i.SyntaxKind.GreaterThanGreaterThanToken:return"op_RightShift";default:return}}function l(e){return i.Node.isParenthesizedExpression(e)?l(e.getExpression()):e}function c(e){return e>=i.SyntaxKind.FirstCompoundAssignment&&e<=i.SyntaxKind.LastCompoundAssignment}function d(e){switch(e){case i.SyntaxKind.PlusEqualsToken:return i.SyntaxKind.PlusToken;case i.SyntaxKind.MinusEqualsToken:return i.SyntaxKind.MinusToken;case i.SyntaxKind.AsteriskEqualsToken:return i.SyntaxKind.AsteriskToken;case i.SyntaxKind.SlashEqualsToken:return i.SyntaxKind.SlashToken;case i.SyntaxKind.PercentEqualsToken:return i.SyntaxKind.PercentToken;case i.SyntaxKind.AmpersandEqualsToken:return i.SyntaxKind.AmpersandToken;case i.SyntaxKind.BarEqualsToken:return i.SyntaxKind.BarToken;case i.SyntaxKind.CaretEqualsToken:return i.SyntaxKind.CaretToken;case i.SyntaxKind.LessThanLessThanEqualsToken:return i.SyntaxKind.LessThanLessThanToken;case i.SyntaxKind.GreaterThanGreaterThanEqualsToken:return i.SyntaxKind.GreaterThanGreaterThanToken;case i.SyntaxKind.GreaterThanGreaterThanGreaterThanEqualsToken:return i.SyntaxKind.GreaterThanGreaterThanGreaterThanToken;default:throw new Error(`Unsupported compound operator: ${i.SyntaxKind[e]}`)}}function u(e,t){const n=e.getSymbol();if(!n)return null;const r=n.getDeclarations();for(const n of r)if(i.Node.isClassDeclaration(n)){const i=n.getMethods().filter((e=>e.getName()===t&&0===e.getTypeParameters().length));for(const t of i){const n=t.getParameters();if(1===n.length&&n[0].getType().getText()===e.getText())return t.getReturnType()}}return null}function p(e,t){return i.Node.isBinaryExpression(e)?g(e,t):i.Node.isPrefixUnaryExpression(e)||i.Node.isPostfixUnaryExpression(e)?m(e,t):t.TypeChecker.getTypeAtLocation(e)}function g(e,t){const n=e.getOperatorToken().getKind();let o=a(n);if(c(n)&&(o=a(d(n))),null==o)return null;if(n===i.SyntaxKind.EqualsEqualsEqualsToken||n===i.SyntaxKind.EqualsEqualsToken||n===i.SyntaxKind.ExclamationEqualsEqualsToken||n==i.SyntaxKind.ExclamationEqualsToken){const t=l(e.getRight());if(i.Node.isNullLiteral(t)||i.Node.isUndefinedKeyword(t))return null;const n=l(e.getLeft());if(i.Node.isNullLiteral(n)||i.Node.isUndefinedKeyword(n))return null}const u=l(e.getLeft()),g=l(e.getRight());let m=p(u,t),y=p(g,t);if(null==m||null==y)return null;if(y.isLiteral()&&(y=t.TypeChecker.getBaseTypeOfLiteralType(y)),m.isLiteral()&&(m=t.TypeChecker.getBaseTypeOfLiteralType(m)),!(0,r.getIsUnityAPIType)(m)&&!(0,r.getIsUnityAPIType)(y))return t.TypeChecker.getTypeAtLocation(e);const h=s(t.TypeChecker,m,o,y),f=s(t.TypeChecker,y,o,m);if(null==h&&null==f)return null;if(c(n)){const e=a(d(n));return null==e?null:s(t.TypeChecker,m,e,y)}return null!=h?h:f}function m(e,t){const n=l(e.getOperand()),i=a(e.getOperatorToken(),!0);return i?u(t.TypeChecker.getTypeAtLocation(n),i):null}t.getOperatorMethodReturnType=s,t.getOperatorMethodName=a,t.unwrapParenthesizedExpression=l,t.isCompoundAssignment=c,t.getEquivalentOperatorForCompound=d,t.getUnaryOperatorMethodReturnType=u,t.getOperatorNodeReturnType=function(e,t){return i.Node.isBinaryExpression(e)?g(e,t):i.Node.isPrefixUnaryExpression(e)||i.Node.isPostfixUnaryExpression(e)?m(e,t):null}},335:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.GeniesLSPContext=void 0,t.GeniesLSPContext=class{constructor(e,t){this.project=e,this.info=t,this.inferredTypesCache=new Map}get LanguageServiceHost(){return this.info.languageServiceHost}get LanguageService(){return this.info.languageService}get Logger(){return this.info.project.projectService.logger}get TypeChecker(){return this.project.getTypeChecker()}getSourceFile(e){let t=this.project.getSourceFile(e);const n=this.getInMemoryFileContent(e,this.info.languageServiceHost);if(t)n?t.replaceWithText(n):t.refreshFromFileSystemSync();else if(t=n?this.project.createSourceFile(e,n,{overwrite:!0}):this.project.addSourceFileAtPath(e),!t)return void this.Logger.info("Source file not found.");return t}getInMemoryFileContent(e,t){const n=t.getScriptSnapshot(e);return n?n.getText(0,n.getLength()):void 0}setInferredType(e,t){this.inferredTypesCache.set(e,t)}getInferredType(e){return this.inferredTypesCache.get(e)}clearInferredTypes(){this.inferredTypesCache.clear()}}},400:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.GeniesScriptTypeDiagnostics=void 0;const i=n(71);t.GeniesScriptTypeDiagnostics=class{constructor(e){this.context=e}get Logger(){return this.context.Logger}enhanceProxy(e){const t=e.getSuggestionDiagnostics;e.getSuggestionDiagnostics=e=>{const n=t(e);return this.getSuggestionDiagnostics(n,e)}}getSuggestionDiagnostics(e,t){const n=this.context.getSourceFile(t);return n?(n.getClasses().filter((e=>(0,i.isGeniesScriptType)(e.getType()))).forEach((t=>{e.filter((e=>(this.Logger.info(`found class ${t.getName()} with range ${t.getStart()} - ${t.getEnd()}`),this.Logger.info(`Code = ${e.code}`),this.Logger.info(`Diagnostic start = ${e.start}`),this.Logger.info(`Diagnostic Message = ${e.messageText}`),6196===e.code&&e.start>=t.getStart()&&e.start<=t.getEnd()))).forEach((t=>{const n=e.indexOf(t);n>-1&&e.splice(n,1)}))})),e):e}}},710:e=>{e.exports=require("ts-morph")},741:function(e,t,n){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.GeniesLifecycleEventsCompletions=void 0;const r=i(n(985)),o=n(710),s=n(71),a=n(60);t.GeniesLifecycleEventsCompletions=class{constructor(e){this.context=e}get Logger(){return this.context.Logger}enhanceProxy(e){const t=e.getCompletionsAtPosition;e.getCompletionsAtPosition=(e,n,i)=>this.getCompletionsAtPosition(t,e,n,i);const n=e.getCompletionEntryDetails;e.getCompletionEntryDetails=(e,t,i,r,o,s,a)=>this.getCompletionEntryDetails(n,e,t,i,r,o,s,a)}getCompletionsAtPosition(e,t,n,i){var o,s,l,c;this.Logger.info("Getting completions at position.");const d=e(t,n,i),u=[],p=this.context.getSourceFile(t);if(!p)return d;const g=null!==(o=null==d?void 0:d.entries.filter((e=>!a.unityLifecycleMethods.find((t=>t.name===e.name)))))&&void 0!==o?o:[],m=this.getRelevantMethods(p,n);return m&&u.push(...m.map((e=>{const t=`private ${e.name}(${e.parameters}) {\n${e.description}\t$0\n}`;return{name:e.name,kind:r.default.ScriptElementKind.memberFunctionElement,kindModifiers:"private",sortText:"0",insertText:t,labelDetails:{description:e.description},isSnippet:!0,hasAction:!0}}))),this.Logger.info("Adding completions for Unity lifecycle methods."),{isGlobalCompletion:null!==(s=null==d?void 0:d.isGlobalCompletion)&&void 0!==s&&s,isMemberCompletion:null!==(l=null==d?void 0:d.isMemberCompletion)&&void 0!==l&&l,isNewIdentifierLocation:null!==(c=null==d?void 0:d.isNewIdentifierLocation)&&void 0!==c&&c,entries:[...null!=g?g:[],...u]}}getCompletionEntryDetails(e,t,n,i,o,s,a,l){const c=e(t,n,i,o,s,a,l);if(c)return c;const d=this.context.getSourceFile(t);if(!d)return c;const u=this.getRelevantMethods(d,n);if(!u)return c;const p=u.find((e=>e.name===i));if(p){const e=[{text:"private",kind:"keyword"},{text:" ",kind:"space"},{text:p.name,kind:"methodName"},{text:"(",kind:"punctuation"}];if(p.parameters){const t=p.parameters.split(",").map((e=>e.trim()));for(let n=0;n<t.length;n++){const[i,r]=t[n].split(":").map((e=>e.trim()));e.push({text:i,kind:"parameterName"}),e.push({text:": ",kind:"punctuation"}),e.push({text:r,kind:"type"}),n<t.length-1&&e.push({text:", ",kind:"punctuation"})}}e.push({text:")",kind:"punctuation"}),e.push({text:" ",kind:"space"});const t=this.createImportChanges(d,p.imports);return{name:p.name,kind:r.default.ScriptElementKind.memberFunctionElement,kindModifiers:"private",displayParts:e,documentation:[{text:p.description,kind:"text"}],tags:[],codeActions:t.length>0?[{description:`Add necessary imports for ${p.name}`,changes:t}]:void 0}}}createImportChanges(e,t){const n=[],i=new Map;return e.getImportDeclarations().forEach((e=>{const t=e.getModuleSpecifierValue(),n=new Set(e.getNamedImports().map((e=>e.getName())));i.set(t,n)})),t.forEach((e=>{const t=i.get(e.module);t?t.has(e.type)||t.add(e.type):i.set(e.module,new Set([e.type]))})),i.forEach(((t,i)=>{const r=e.getImportDeclaration(i);if(r){const i=r.getNamedImports().map((e=>e.getName())),o=Array.from(t).filter((e=>!i.includes(e)));if(o.length>0){const t=r.getNamedImports().pop();t&&n.push({fileName:e.getFilePath(),textChanges:[{newText:`, ${o.join(", ")}`,span:{start:t.getEnd(),length:0}}]})}}else n.push({fileName:e.getFilePath(),textChanges:[{newText:`import { ${Array.from(t).join(", ")} } from '${i}';\n`,span:{start:0,length:0}}]})})),n}getRelevantMethods(e,t){const n=e.getDescendantAtPos(t);if(n){const e=this.getEnclosingClassDeclaration(n,t);if(e){if(!this.isPositionInClassBodyOnly(e,t))return;const n=e.getType(),i=(0,s.getGeniesScriptTypeFromType)(n);if(i===s.GeniesScriptType.None)return void this.Logger.info("No relevant methods found for the script type.");const r=e.getMethods().map((e=>e.getName())),o=a.unityLifecycleMethods.filter((e=>!r.includes(e.name)));let l=[];return i===s.GeniesScriptType.Monobehaviour?l=o:i===s.GeniesScriptType.ScriptableObject&&(l=o.filter((e=>a.ScriptableObjectAllowedMethods.includes(e.name)))),l}}}getEnclosingClassDeclaration(e,t){let n=e;for(;n;){if(o.Node.isClassDeclaration(n)){const e=n.getStart(),i=n.getEnd();if(e<=t&&t<=i)return n}n=n.getParent()}}isPositionInClassBodyOnly(e,t){const n=e.getFirstChildByKind(o.SyntaxKind.OpenBraceToken),i=e.getFirstChildByKind(o.SyntaxKind.CloseBraceToken);if(!n||!i)return!1;const r=n.getEnd(),s=i.getStart();if(t<r||t>s)return!1;const a=e.getSourceFile().getDescendantAtPos(t);if(!a)return!1;const l=a.getParent(),c=null==l?void 0:l.getParent();return l===e||l===n||l===i||c===e}}},830:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.GeniesLifecycleEventsDiagnostics=void 0;const i=n(60),r=n(71);t.GeniesLifecycleEventsDiagnostics=class{constructor(e){this.context=e}get Logger(){return this.context.Logger}enhanceProxy(e){const t=e.getSuggestionDiagnostics;e.getSuggestionDiagnostics=e=>{const n=t(e);return this.getSuggestionDiagnostics(n,e)}}getSuggestionDiagnostics(e,t){const n=this.context.getSourceFile(t);if(!n)return e;const o=new Set(i.unityLifecycleMethods.map((e=>e.name)));return n.getClasses().filter((e=>(0,r.isGeniesScriptType)(e.getType()))).flatMap((e=>e.getMethods())).filter((e=>o.has(e.getName()))).forEach((t=>{e.filter((e=>6133===e.code&&e.start===t.getNameNode().getStart())).forEach((t=>{const n=e.indexOf(t);n>-1&&e.splice(n,1)}))})),e}}},865:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.GeniesSemanticDiagnostics=void 0;const i=n(105);t.GeniesSemanticDiagnostics=class{constructor(e){this.context=e}get Logger(){return this.context.Logger}enhanceProxy(e){const t=e.getSemanticDiagnostics;e.getSemanticDiagnostics=e=>{let n=t(e);return n=this.getGeniesSemanticDiagnostics(n,e),n}}getGeniesSemanticDiagnostics(e,t){const n=this.context.getSourceFile(t);if(!n)return e;const r=(0,i.getGeniesSemanticDiagnostics)(n,this.context.TypeChecker);return[...e.filter((e=>!r.some((t=>t.messageText===e.messageText&&t.start===e.start&&t.length===e.length)))),...r]}}},928:e=>{e.exports=require("path")},985:e=>{e.exports=require("typescript/lib/tsserverlibrary")}},t={};return function n(i){var r=t[i];if(void 0!==r)return r.exports;var o=t[i]={exports:{}};return e[i].call(o.exports,o,o.exports,n),o.exports}(26)})()));
//# sourceMappingURL=index.js.map